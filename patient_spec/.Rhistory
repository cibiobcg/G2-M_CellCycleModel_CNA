library(ggplot2)
library(dplyr)
library(org.Hs.eg.db)
library(tidyverse)
library(edgeR)
library(DESeq2)
library(recount3)
library(recount)
library(biomaRt)
library(sva)
library(rstudioapi)
library(ggplot2)
library(preprocessCore)
library(ggplot2)
library(dplyr)
# library(GenomicDataCommons)
# library(magrittr)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
eqtl_names <- list('FOXM1','CDC25C','CCNB1','CHEK1','WEE1','CDK1','MARK3','CTDP1') # da cambiare nome
`%nin%` <- Negate(`%in%`)
# for (file in list.files()){
#   if(grepl('.csv',file)){
#     eqtl <- strsplit(file,'_')[[1]][1]
#     eqtl_names <- append(eqtl_names,toupper(eqtl))
# }}
brca1 <- recount3::create_rse_manual(
project = "BRCA",
project_home = "data_sources/tcga",
organism = "human",
annotation = "gencode_v26",
type = "gene"
)
assays(brca1)$counts <- compute_read_counts(brca1)
##### retrive tcga barcodes of the samples ####
tcga <- as.data.frame(brca1@colData)
tcga_normal <- tcga[which(tcga$tcga.cgc_sample_sample_type == 'Solid Tissue Normal'),]
tcga <- tcga[which(tcga$tcga.cgc_sample_sample_type != 'Solid Tissue Normal' & tcga$tcga.cgc_sample_sample_type != 'Metastatic' ),] # removed the normal samples and remove also the Metastatic
#there are samples that present the same tcga barcod, retrive the rows
dup <- tcga[duplicated(tcga$tcga.gdc_cases.submitter_id),]# there are duplicates
# tcga <- tcga %>% arrange(desc(tcga.gdc_cases.samples.sub'itter_id))
# for normal tissues
new_barcodes_healthy <- list()
n = 0
for (bar in tcga_normal$tcga.tcga_barcode){
if(grepl('11[[:alpha:]]',bar)){
new_barcodes_healthy <- append(new_barcodes_healthy,bar)
} }
newer_barcodes_healthy <- list()
for (barcode in new_barcodes_healthy){
phases <- unlist(strsplit(barcode,'-',fixed = T))
change_bar <- substr(phases[4],1,2)
bar_new <- paste0(phases[1],'-',phases[2],'-',phases[3],'-',change_bar)
newer_barcodes_healthy <- append(newer_barcodes_healthy,bar_new)
}
# tumor
new_barcodes <- list()
n = 0
for (bar in tcga$tcga.tcga_barcode){
if(grepl('01[[:alpha:]]',bar)){
new_barcodes <- append(new_barcodes,bar)
} }
#cambiare e tenere solo quelli con A finale
newer_barcodes <- list()
for (barcode in new_barcodes){
phases <- unlist(strsplit(barcode,'-',fixed = T))
change_bar <- substr(phases[4],1,3)
bar_new <- paste0(phases[1],'-',phases[2],'-',phases[3],'-',change_bar)
newer_barcodes <- append(newer_barcodes,bar_new)
}
###TPM ####
Brca_tpm <- as.data.frame(recount::getTPM(brca1,length_var = 'bp_length', mapped_var = NULL))
Brca_tpm2 <- str_replace(rownames(Brca_tpm),
pattern = ".[0-9]+$",
replacement = "")
rownames(Brca_tpm) <- Brca_tpm2
Brca_tpm_norm <- Brca_tpm[which(colnames(Brca_tpm) %in% tcga_normal$external_id)]
Brca_tpm <- Brca_tpm[which(colnames(Brca_tpm) %in% tcga$external_id)]
Brca_tpm <- Brca_tpm %>% rownames_to_column('ensembl_id')
Brca_tpm_norm <- Brca_tpm_norm %>%  rownames_to_column('ensembl_id')
# reduced from 1127 to 1093
colnames(Brca_tpm)[2:1128] <- newer_barcodes
colnames(Brca_tpm_norm)[2:113] <-newer_barcodes_healthy
### for tumors there are replicates so
Brca_tpm <- Brca_tpm[, !duplicated(colnames(Brca_tpm))]
Brca_tpm_momentary<- Brca_tpm %>% dplyr::select(ends_with('A'))
newest_barcodes <- list()
for (barcode in colnames(Brca_tpm_momentary)){
phases <- unlist(strsplit(barcode,'-',fixed = T))
change_bar <- substr(phases[4],1,2)
bar_new <- paste0(phases[1],'-',phases[2],'-',phases[3],'-',change_bar)
newest_barcodes <- append(newest_barcodes,bar_new)
}
colnames(Brca_tpm_momentary) <-newest_barcodes
Brca_tpm_momentary$ensembl_id <- Brca_tpm$ensembl_id # 1080 samples
trial1 <- sapply(Brca_tpm_momentary[1:1080], as.matrix)
trail2 <- tidyr::gather(as.data.frame(trial1[,1:80]),key = 'sample',value = 'read_number')
#
ggplot() +
geom_boxplot(alpha = 0.7, mapping = aes(sample,log10(read_number+1)),data = trail2)+
theme_bw()+
scale_x_discrete(guide = guide_axis(angle = 90))#+
ggsave('plots/BRCA_tcga_80_tpmonly.pdf',plot = last_plot(),width = 40, height = 40, units = 'cm')
### healthy tissues
trial1_norm <- sapply(Brca_tpm_norm[2:113], as.matrix)
trail2_norm <- tidyr::gather(as.data.frame(trial1_norm[,1:80]),key = 'sample',value = 'read_number')
#
ggplot() +
geom_boxplot(alpha = 0.7, mapping = aes(sample,log10(read_number+1)),data = trail2_norm)+
theme_bw()+
scale_x_discrete(guide = guide_axis(angle = 90))
ggsave('plots/BRCA_tcga_80_tpmonly_healthy.pdf',plot = last_plot(),width = 40, height = 40, units = 'cm')
#### quantile normalization ####
Brca_norm <- as.data.frame(normalize.quantiles(sapply(Brca_tpm_momentary[1:1080], as.matrix), copy = TRUE))
colnames(Brca_norm) <- colnames(Brca_tpm_momentary[1:1080])
Brca_norm_plot <- tidyr::gather(Brca_norm[,1:80],key = 'sample',value = 'read_number')
#
ggplot() +
geom_boxplot(alpha = 0.7, mapping = aes(sample,log10(read_number+1)),data = Brca_norm_plot)+
theme_bw()+
scale_x_discrete(guide = guide_axis(angle = 90))#+
ggsave('plots/BRCA_tcga_80_tpm_quant.pdf',plot = last_plot(),width = 40, height = 40, units = 'cm')
### healthy tissues
Brca_norm_healthy <- as.data.frame(normalize.quantiles(sapply(Brca_tpm_norm[2:113], as.matrix), copy = TRUE))
colnames(Brca_norm_healthy) <- colnames(Brca_tpm_norm[2:113])
Brca_norm_plot_healthy <- tidyr::gather(Brca_norm_healthy[,1:80],key = 'sample',value = 'read_number')
#
ggplot() +
geom_boxplot(alpha = 0.7, mapping = aes(sample,log10(read_number+1)),data = Brca_norm_plot_healthy)+
theme_bw()+
scale_x_discrete(guide = guide_axis(angle = 90))#+
ggsave('plots/BRCA_tcga_80_tpm_quant_helthy.pdf',plot = last_plot(),width = 40, height = 40, units = 'cm')
Brca_norm <- Brca_norm %>% add_column(ensembl_gene_id = Brca_tpm_momentary$ensembl_id, .before = 'TCGA-E9-A249-01')
Brca_norm_healthy <- Brca_norm_healthy  %>% add_column(ensembl_gene_id = Brca_tpm_norm$ensembl_id, .before = 'TCGA-BH-A0B8-11')
ensembl <- useEnsembl(biomart = 'genes',
dataset = 'hsapiens_gene_ensembl',
version = 113)
annotation_brca <- getBM(attributes = c( 'hgnc_symbol','ensembl_gene_id'),
filters = 'hgnc_symbol',
values = unlist(eqtl_names),
mart = ensembl)
Brca_final <- merge(Brca_norm,annotation_brca,by = 'ensembl_gene_id')
row_sums <- rowSums(Brca_final[,2:1080])
row_sums # second CTDP1 present less information so will be eliminated
Brca_final <- Brca_final[!duplicated(Brca_final$hgnc_symbol),]
Brca_norm_plot <- tidyr::gather(Brca_final,key = 'sample',value = 'value',-c('ensembl_gene_id','hgnc_symbol'))
Brca_norm_plot$value <- as.numeric(Brca_norm_plot$value)
Brca_norm_plot$value <- round(Brca_norm_plot$value,2)
ggplot(Brca_norm_plot, aes(x=hgnc_symbol, y =log10(value +1) , fill =hgnc_symbol )) + geom_boxplot() + theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) + xlab('Gene Name') + ylab('log10(TPM + 1)') + ggtitle('BRCA TCGA 1080 samples TPM then quantile normalization')
ggsave('plots/BRCA_gene_expression.pdf',plot = last_plot())
####### healthy
Brca_final_healthy <- merge(Brca_norm_healthy,annotation_brca,by = 'ensembl_gene_id')
row_sums_healthy <- rowSums(Brca_final_healthy[,2:113])
Brca_final_healthy <- Brca_final_healthy[!duplicated(Brca_final_healthy$hgnc_symbol),]
Brca_norm_plot_healthy_2 <- tidyr::gather(Brca_final_healthy,key = 'sample',value = 'value',-c('ensembl_gene_id','hgnc_symbol'))
Brca_norm_plot_healthy_2$value <- round(Brca_norm_plot_healthy_2$value,2)
ggplot(Brca_norm_plot_healthy_2, aes(x=hgnc_symbol, y =log10(value +1) , fill =hgnc_symbol )) + geom_boxplot() + theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) + xlab('Gene Name') + ylab('log10(TPM + 1)') + ggtitle('BRCA TCGA 112 healthy samples TPM then quantile normalization')
ggsave('plots/BRCA_gene_expression_healthy.pdf',plot = last_plot())
##########################
##########################
setwd('Cbioportal')
FOXM1 <- read.delim('FOXM1_cbiportal_dataplot.txt',header = T)
# FOXM1 <- FOXM1 %>% filter(FOXM1..Putative.copy.number.alterations.from.GISTIC == 'Deep Deletion' | FOXM1..Putative.copy.number.alterations.from.GISTIC =='Amplification' | FOXM1..Putative.copy.number.alterations.from.GISTIC =='Diploid')
FOXM1 <- FOXM1[!duplicated(FOXM1$Sample.Id), ]
Brca_norm_plot$copy_number_alteration <- NA
for (sample in FOXM1$Sample.Id){
# if(sample %in% Brca_norm_plot$sample && Brca_norm_plot$hgnc_symbol == 'FOXM1'){
#   print(rownames(Brca_norm_plot$sample))
# }
if(sample %in% Brca_norm_plot$sample){
Brca_norm_plot[which(Brca_norm_plot$sample == sample & Brca_norm_plot$hgnc_symbol == 'FOXM1'),]$copy_number_alteration <- FOXM1[which(FOXM1$Sample.Id == sample),]$FOXM1..Putative.copy.number.alterations.from.GISTIC
}
}
CCNB1 <- read.delim('CCNB1_cbiportal_dataplot.txt',header = T)
# CCNB1 <- CCNB1 %>% filter(CCNB1..Putative.copy.number.alterations.from.GISTIC == 'Deep Deletion' | CCNB1..Putative.copy.number.alterations.from.GISTIC =='Amplification' | CCNB1..Putative.copy.number.alterations.from.GISTIC =='Diploid')
CCNB1 <- CCNB1[!duplicated(CCNB1$Sample.Id), ]
for (sample in CCNB1$Sample.Id){
# if(sample %in% Brca_norm_plot$sample && Brca_norm_plot$hgnc_symbol == 'FOXM1'){
#   print(rownames(Brca_norm_plot$sample))
# }
if(sample %in% Brca_norm_plot$sample){
Brca_norm_plot[which(Brca_norm_plot$sample == sample & Brca_norm_plot$hgnc_symbol == 'CCNB1'),]$copy_number_alteration <- CCNB1[which(CCNB1$Sample.Id == sample),]$CCNB1..Putative.copy.number.alterations.from.GISTIC
}
}
CDC25C <- read.delim('CDC25C_cbiportal_dataplot.txt',header = T)
# CDC25C <- CDC25C %>% filter(CDC25C..Putative.copy.number.alterations.from.GISTIC == 'Deep Deletion' | CDC25C..Putative.copy.number.alterations.from.GISTIC =='Amplification' | CDC25C..Putative.copy.number.alterations.from.GISTIC =='Diploid')
CDC25C <- CDC25C[!duplicated(CDC25C$Sample.Id), ]
for (sample in CDC25C$Sample.Id){
# if(sample %in% Brca_norm_plot$sample && Brca_norm_plot$hgnc_symbol == 'FOXM1'){
#   print(rownames(Brca_norm_plot$sample))
# }
if(sample %in% Brca_norm_plot$sample){
Brca_norm_plot[which(Brca_norm_plot$sample == sample & Brca_norm_plot$hgnc_symbol == 'CDC25C'),]$copy_number_alteration <- CDC25C[which(CDC25C$Sample.Id == sample),]$CDC25C..Putative.copy.number.alterations.from.GISTIC
}
}
CDK1 <- read.delim('CDK1_cbiportal_dataplot.txt',header = T)
# CDK1 <- CDK1 %>% filter(CDK1..Putative.copy.number.alterations.from.GISTIC == 'Deep Deletion' | CDK1..Putative.copy.number.alterations.from.GISTIC =='Amplification' | CDK1..Putative.copy.number.alterations.from.GISTIC =='Diploid')
CDK1 <- CDK1[!duplicated(CDK1$Sample.Id), ]
for (sample in CDK1$Sample.Id){
# if(sample %in% Brca_norm_plot$sample && Brca_norm_plot$hgnc_symbol == 'FOXM1'){
#   print(rownames(Brca_norm_plot$sample))
# }
if(sample %in% Brca_norm_plot$sample){
Brca_norm_plot[which(Brca_norm_plot$sample == sample & Brca_norm_plot$hgnc_symbol == 'CDK1'),]$copy_number_alteration <- CDK1[which(CDK1$Sample.Id == sample),]$CDK1..Putative.copy.number.alterations.from.GISTIC
}
}
CHEK1 <- read.delim('CHEK1_cbiportal_dataplot.txt',header = T)
# CHEK1 <- CHEK1 %>% filter(CHEK1..Putative.copy.number.alterations.from.GISTIC == 'Deep Deletion' | CHEK1..Putative.copy.number.alterations.from.GISTIC =='Amplification' |  CHEK1..Putative.copy.number.alterations.from.GISTIC =='Diploid')
CHEK1 <- CHEK1[!duplicated(CHEK1$Sample.Id), ]
for (sample in CHEK1$Sample.Id){
# if(sample %in% Brca_norm_plot$sample && Brca_norm_plot$hgnc_symbol == 'FOXM1'){
#   print(rownames(Brca_norm_plot$sample))
# }
if(sample %in% Brca_norm_plot$sample){
Brca_norm_plot[which(Brca_norm_plot$sample == sample & Brca_norm_plot$hgnc_symbol == 'CHEK1'),]$copy_number_alteration <- CHEK1[which(CHEK1$Sample.Id == sample),]$CHEK1..Putative.copy.number.alterations.from.GISTIC
}
}
CTDP1 <- read.delim('CTDP1_cbiportal_dataplot.txt',header = T)
# CTDP1 <- CTDP1 %>% filter(CTDP1..Putative.copy.number.alterations.from.GISTIC == 'Deep Deletion' | CTDP1..Putative.copy.number.alterations.from.GISTIC =='Amplification' | CTDP1..Putative.copy.number.alterations.from.GISTIC =='Diploid')
CTDP1 <- CTDP1[!duplicated(CTDP1$Sample.Id), ]
for (sample in CTDP1$Sample.Id){
# if(sample %in% Brca_norm_plot$sample && Brca_norm_plot$hgnc_symbol == 'FOXM1'){
#   print(rownames(Brca_norm_plot$sample))
# }
if(sample %in% Brca_norm_plot$sample){
Brca_norm_plot[which(Brca_norm_plot$sample == sample & Brca_norm_plot$hgnc_symbol == 'CTDP1'),]$copy_number_alteration <- CTDP1[which(CTDP1$Sample.Id == sample),]$CTDP1..Putative.copy.number.alterations.from.GISTIC
}
}
MARK3 <- read.delim('MARK3_cbiportal_dataplot.txt',header = T)
# MARK3 <- MARK3 %>% filter(MARK3..Putative.copy.number.alterations.from.GISTIC == 'Deep Deletion' | MARK3..Putative.copy.number.alterations.from.GISTIC =='Amplification' | MARK3..Putative.copy.number.alterations.from.GISTIC =='Diploid')
MARK3 <- MARK3[!duplicated(MARK3$Sample.Id), ]
for (sample in MARK3$Sample.Id){
# if(sample %in% Brca_norm_plot$sample && Brca_norm_plot$hgnc_symbol == 'FOXM1'){
#   print(rownames(Brca_norm_plot$sample))
# }
if(sample %in% Brca_norm_plot$sample){
Brca_norm_plot[which(Brca_norm_plot$sample == sample & Brca_norm_plot$hgnc_symbol == 'MARK3'),]$copy_number_alteration <- MARK3[which(MARK3$Sample.Id == sample),]$MARK3..Putative.copy.number.alterations.from.GISTIC
}
}
WEE1 <- read.delim('WEE1_cbiportal_dataplot.txt',header = T)
# WEE1 <- WEE1 %>% filter(WEE1..Putative.copy.number.alterations.from.GISTIC == 'Deep Deletion' | WEE1..Putative.copy.number.alterations.from.GISTIC =='Amplification' | WEE1..Putative.copy.number.alterations.from.GISTIC =='Diploid')
WEE1 <- WEE1[!duplicated(WEE1$Sample.Id), ]
for (sample in WEE1$Sample.Id){
# if(sample %in% Brca_norm_plot$sample && Brca_norm_plot$hgnc_symbol == 'FOXM1'){
#   print(rownames(Brca_norm_plot$sample))
# }
if(sample %in% Brca_norm_plot$sample){
Brca_norm_plot[which(Brca_norm_plot$sample == sample & Brca_norm_plot$hgnc_symbol == 'WEE1'),]$copy_number_alteration <- WEE1[which(WEE1$Sample.Id == sample),]$WEE1..Putative.copy.number.alterations.from.GISTIC
}
}
table(Brca_norm_plot$copy_number_alteration)
#####
# Amplification    Deep Deletion  Diploid         Gain Shallow    Deletion
# 59               40             4399             1218             2148
Brca_norm_plot_wt_cn <- Brca_norm_plot %>% na.omit() # some are not present in file cbiportal
#reduced to 983 samples from cbiportal
setwd('../plots')
linear_Regression_gene <- new.env()
Brca_norm_plot_wt_cn[which(Brca_norm_plot_wt_cn$hgnc_symbol == 'CTDP1'),]$hgnc_symbol <- 'FCP1'
Brca_norm_plot_wt_cn[which(Brca_norm_plot_wt_cn$hgnc_symbol == 'MARK3'),]$hgnc_symbol <- 'C-TAK1'
Brca_norm_plot_wt_cn[which(Brca_norm_plot_wt_cn$hgnc_symbol == 'CHEK1'),]$hgnc_symbol <- 'CHK1'
table_patient_specific <- subset(Brca_norm_plot_wt_cn,select=c('sample','hgnc_symbol','copy_number_alteration'))
for(names in unique(table_patient_specific$hgnc_symbol)){
if(names == 'CCNB1' || names == 'CDC25C'){
table_patient_specific[which(table_patient_specific$hgnc_symbol == names),]$copy_number_alteration <- NA
}
}
table_patient_specific <- table_patient_specific %>%  na.omit()
View(table_patient_specific)
unique(table_patient_specific$hgnc_symbol)
View(table_patient_specific)
table_patient_for_paper <- data.frame(id_patient = table_patient_specific$sample, FCP1 = 'Diploid',C-TAK1 = 'Diploid',FOXM1 = 'Diploid',
unique(table_patient_specific$sample)
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',C-TAK1 = 'Diploid',FOXM1 = 'Diploid',
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',C-TAK1 = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid')
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',C_TAK1 = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid')
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',`C-TAK1` = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid')
table_patient_for_paper
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',`C-TAK1` = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid')
table_patient_for_paper_columns <- colnames(table_patient_for_paper)[-1]
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',`C-TAK1` = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid', check.names = F)
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',`C-TAK1` = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid', check.names = F)
table_patient_for_paper_columns <- colnames(table_patient_for_paper)[-1]
rowe =1
id_pat <- table_patient_specific$sample[rowe]
gene <- table_patient_specific$hgnc_symbol[rowe]
status <- table_patient_specific$copy_number_alteration[rowe]
table_patient_for_paper[id_pat,gene] <- status
View(table_patient_for_paper)
table_patient_for_paper[id_pat,gene]
table_patient_for_paper[which(table_patient_for_paper$id_patient == id_pat),]
table_patient_for_paper[id_pat,]
tail(table_patient_for_paper,2)
table_patient_for_paper[which(table_patient_for_paper$id_patient == id_pat),]
table_patient_for_paper[which(table_patient_for_paper$id_patient == id_pat),gene]
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',`C-TAK1` = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid', check.names = F)
table_patient_for_paper_columns <- colnames(table_patient_for_paper)[-1]
table_patient_for_paper[which(table_patient_for_paper$id_patient == id_pat),gene] <- status
table_patient_for_paper[which(table_patient_for_paper$id_patient == id_pat),]
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',`C-TAK1` = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid', check.names = F)
table_patient_for_paper_columns <- colnames(table_patient_for_paper)[-1]
for( rowe in 1:length(table_patient_specific$id_patient)){
rowe =1
id_pat <- table_patient_specific$sample[rowe]
gene <- table_patient_specific$hgnc_symbol[rowe]
status <- table_patient_specific$copy_number_alteration[rowe]
if (gene %in% table_patient_for_paper_columns){
table_patient_for_paper[which(table_patient_for_paper$id_patient == id_pat),gene] <- status
}
}
write_csv(table_patient_for_paper,'table_paper_patient_spec.csv')
getwd()
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',`C-TAK1` = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid', check.names = F)
table_patient_for_paper_columns <- colnames(table_patient_for_paper)[-1]
for( rowe in 1:length(table_patient_specific$id_patient)){
id_pat <- table_patient_specific$sample[rowe]
gene <- table_patient_specific$hgnc_symbol[rowe]
status <- table_patient_specific$copy_number_alteration[rowe]
if (gene %in% table_patient_for_paper_columns){
table_patient_for_paper[which(table_patient_for_paper$id_patient == id_pat),gene] <- status
}
}
unique(table_patient_specific$hgnc_symbol)
unique(table_patient_specific$hgnc_symbol) %in% table_patient_for_paper_columns
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',`C-TAK1` = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid', check.names = F)
table_patient_for_paper_columns <- colnames(table_patient_for_paper)[-1]
for( rowe in 1:length(table_patient_specific$id_patient)){
id_pat <- table_patient_specific$sample[rowe]
gene <- table_patient_specific$hgnc_symbol[rowe]
status <- table_patient_specific$copy_number_alteration[rowe]
print(gene)
if (gene %in% table_patient_for_paper_columns){
table_patient_for_paper[which(table_patient_for_paper$id_patient == id_pat),gene] <- status
}
}
for( rowe in 1:length(table_patient_specific$id_patient)){
print(rowe)
id_pat <- table_patient_specific$sample[rowe]
gene <- table_patient_specific$hgnc_symbol[rowe]
status <- table_patient_specific$copy_number_alteration[rowe]
print(gene)
if (gene %in% table_patient_for_paper_columns){
table_patient_for_paper[which(table_patient_for_paper$id_patient == id_pat),gene] <- status
}
}
table_patient_specific$id_patient
View(table_patient_for_paper)
View(table_patient_specific)
table_patient_specific$id_patient)
table_patient_specific$id_patient
View(table_patient_specific)
table_patient_specific$sample
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',`C-TAK1` = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid', check.names = F)
table_patient_for_paper_columns <- colnames(table_patient_for_paper)[-1]
for( rowe in 1:length(table_patient_specific$sample)){
print(rowe)
id_pat <- table_patient_specific$sample[rowe]
gene <- table_patient_specific$hgnc_symbol[rowe]
status <- table_patient_specific$copy_number_alteration[rowe]
print(gene)
if (gene %in% table_patient_for_paper_columns){
table_patient_for_paper[which(table_patient_for_paper$id_patient == id_pat),gene] <- status
}
}
table_patient_for_paper <- data.frame(id_patient = unique(table_patient_specific$sample), FCP1 = 'Diploid',`C-TAK1` = 'Diploid',FOXM1 = 'Diploid',CHK1 = 'Diploid',WEE1 = 'Diploid',CDK1 = 'Diploid', check.names = F)
table_patient_for_paper_columns <- colnames(table_patient_for_paper)[-1]
for( rowe in 1:length(table_patient_specific$sample)){
print(rowe)
id_pat <- table_patient_specific$sample[rowe]
gene <- table_patient_specific$hgnc_symbol[rowe]
status <- table_patient_specific$copy_number_alteration[rowe]
print(gene)
print(status)
if (gene %in% table_patient_for_paper_columns){
table_patient_for_paper[which(table_patient_for_paper$id_patient == id_pat),gene] <- status
}
}
View(table_patient_for_paper)
write_csv(table_patient_for_paper,'../table_paper_patient_spec.csv')
View(table_patient_for_paper)
library(ggplot2)
# library(rstudioapi)
library(dplyr)
library(parallel)
library(data.table)
library(doParallel)
library(parallel)
patient_spec <- read.csv('../table_patient_specific.csv')
copy_number <- read.csv('../final_rates_copynumbers.csv')
View(copy_number)
View(patient_spec)
View(copy_number)
View(patient_spec)
View(copy_number)
View(copy_number)
View(patient_spec)
View(copy_number)
setwd("~/Desktop/Paper_cell_cycle/patient_spec")
paper_pat_spec <- read.csv('table_paper_patient_spec.csv')
View(paper_pat_spec)
copy_number[which(copy_number$Gene == 'CDK1' & copy_number$Copy_number == 'Diploid'),]$linear_reg_values
View(patient_spec)
View(copy_number)
colname(paper_pat_spec)
colnames(paper_pat_spec)
colnames(paper_pat_spec)[-1]
paper_pat_spec <- read.csv('table_paper_patient_spec.csv')
colnames(paper_pat_spec)[-1]
View(copy_number)
View(copy_number)
gene == "C.TAK1"
gene = "C.TAK1"
copy_number[which(copy_number$Gene == gene),]
colnames(paper_pat_spec)
colnames(paper_pat_spec)[3]
colnames(paper_pat_spec)[3] <- 'C-TAK1'
colnames(paper_pat_spec)
colnames(paper_pat_spec)[-1]
gene = "C-TAK1"
copy_number[which(copy_number$Gene == gene),]
head(paper_pat_spec$id_patient)
id_patient =  "TCGA-E9-A249-01"
paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),]
View(patient_spec)
gene = "WEE1"
status_pat <- paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene]
View(copy_number)
val_status <- copy_number[which(copy_number$Gene == gene & copy_number$Copy_number == status_pat),]$values
paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene]
paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene] <- val_status
View(paper_pat_spec)
status_pat <- paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene]
gene = "CDK1"
status_pat <- paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene]
val_status <- copy_number[which(copy_number$Gene == gene & copy_number$Copy_number == status_pat),]$linear_reg_values
divider_kms <- copy_number[which(copy_number$Gene == 'CDK1' & copy_number$Copy_number == 'Diploid'),]$linear_reg_values
change <- (0.004/divider_kms) * rate_kms
change <- (0.004/divider_kms) * val_status
paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene] <- change
View(paper_pat_spec)
paper_pat_spec <- read.csv('table_paper_patient_spec.csv')
copy_number <- read.csv('../final_rates_copynumbers.csv')
copy_number <- read.csv('final_rates_copynumbers.csv')
setwd("~/Desktop/Paper_cell_cycle/patient_spec")
paper_pat_spec <- read.csv('table_paper_patient_spec.csv')
copy_number <- read.csv('../final_rates_copynumbers.csv')
copy_number <- read.csv('../copy_number_analysis/final_rates_copynumbers.csv')
View(copy_number)
colnames(paper_pat_spec)[3] <- 'C-TAK1'
for (id_patient in paper_pat_spec$id_patient){
for (gene in colnames(paper_pat_spec)[-1]){
if (gene == 'CDK1'){
status_pat <- paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene]
val_status <- copy_number[which(copy_number$Gene == gene & copy_number$Copy_number == status_pat),]$linear_reg_values
divider_kms <- copy_number[which(copy_number$Gene == 'CDK1' & copy_number$Copy_number == 'Diploid'),]$linear_reg_values
change <- (0.004/divider_kms) * val_status
paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene] <- change
}else{
status_pat <- paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene]
val_status <- copy_number[which(copy_number$Gene == gene & copy_number$Copy_number == status_pat),]$values
paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene] <- val_status
}
}
}
paper_pat_spec <- read.csv('table_paper_patient_spec.csv')
copy_number <- read.csv('../copy_number_analysis/final_rates_copynumbers.csv')
colnames(paper_pat_spec)[3] <- 'C-TAK1'
View(copy_number)
paper_pat_spec <- read.csv('table_paper_patient_spec.csv')
copy_number <- read.csv('final_rates_copynumbers.csv')
unique(copy_number$Gene)
colnames(paper_pat_spec)[3] <- 'C-TAK1'
for (id_patient in paper_pat_spec$id_patient){
for (gene in colnames(paper_pat_spec)[-1]){
if (gene == 'CDK1'){
status_pat <- paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene]
val_status <- copy_number[which(copy_number$Gene == gene & copy_number$Copy_number == status_pat),]$linear_reg_values
divider_kms <- copy_number[which(copy_number$Gene == 'CDK1' & copy_number$Copy_number == 'Diploid'),]$linear_reg_values
change <- (0.004/divider_kms) * val_status
paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene] <- change
}else{
status_pat <- paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene]
val_status <- copy_number[which(copy_number$Gene == gene & copy_number$Copy_number == status_pat),]$values
paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene] <- val_status
}
}
}
View(paper_pat_spec)
View(paper_pat_spec)
paper_pat_spec <- read.csv('table_paper_patient_spec.csv')
copy_number <- read.csv('final_rates_copynumbers.csv')
copy_number
colnames(paper_pat_spec)[3] <- 'C-TAK1'
for (id_patient in paper_pat_spec$id_patient){
for (gene in colnames(paper_pat_spec)[-1]){
if (gene == 'CDK1'){
status_pat <- paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene]
val_status <- copy_number[which(copy_number$Gene == gene & copy_number$Copy_number == status_pat),]$linear_reg_values
divider_kms <- copy_number[which(copy_number$Gene == 'CDK1' & copy_number$Copy_number == 'Diploid'),]$linear_reg_values
change <- round((0.004/divider_kms) * val_status,5)
paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene] <- change
}else{
status_pat <- paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene]
val_status <- round(copy_number[which(copy_number$Gene == gene & copy_number$Copy_number == status_pat),]$values,0)
paper_pat_spec[which(paper_pat_spec$id_patient == id_patient),gene] <- val_status
}
}
}
View(paper_pat_spec)
write_csv(paper_pat_spec,'Species_and_parameter_pat_spec.csv')
getwd()
