load('env_total.Rdata')
Initial_val500[which(Initial_val500$Specie == 'inhibitor_p'),]$Specie <- 'WEE1'
Initial_val500[which(Initial_val500$Specie == 'TF_a'),]$Specie <- 'FOXM1_plus_CTAK1'
Initial_val500[which(Initial_val500$Specie == 'E_1'),]$Specie <- 'FCP1'
# update lable for human
Initial_val500[which(Initial_val500$Specie == 'inhibitor_p'),]$Specie <- 'WEE1'
Initial_val500[which(Initial_val500$Specie == 'TF_a'),]$Specie <- 'FOXM1_plus_CTAK1'
View(Initial_val50)
# update lable for human
Initial_val500[which(Initial_val500$Specie == 'inhibitor_p'),]$Specie <- 'WEE1'
View(Initial_val500)
#times
ggplot(data=Initial_val500 %>% group_by(Specie, Quant_spec) %>% summarise(Mean = mean(Time)), aes(Mean, Specie, fill = Specie)) +
geom_boxplot() + geom_vline(xintercept = mean(normal500$Time), colour = 'red', lwd =0.2) +
geom_point(position=position_dodge(),aes(group = Mean, colour = Quant_spec)) +
scale_colour_gradient(low = '#605b8f',high = '#de425b') + labs(title = 'Sensitivity Analysis Species',x='Time' ,y='Species')
library(ggplot2)
# library(rstudioapi)
library(dplyr)
library(parallel)
library(data.table)
library(doParallel)
library(parallel)
#times
ggplot(data=Initial_val500 %>% group_by(Specie, Quant_spec) %>% summarise(Mean = mean(Time)), aes(Mean, Specie, fill = Specie)) +
geom_boxplot() + geom_vline(xintercept = mean(normal500$Time), colour = 'red', lwd =0.2) +
geom_point(position=position_dodge(),aes(group = Mean, colour = Quant_spec)) +
scale_colour_gradient(low = '#605b8f',high = '#de425b') + labs(title = 'Sensitivity Analysis Species',x='Time' ,y='Species')
View(normal500)
View(moment50)
View(normal500)
plot(normal500$Time)
ggplot(normal500, aes(Time)) +
geom_freqpoly(binwidth = 500)
ggplot(normal500, aes(Time)) +
geom_histogram(binwidth = 500)
ggplot(normal500, aes(Time)) +
geom_histogram(binwidth = 100)
ggplot(normal500, aes(Time)) +
geom_histogram(binwidth = 50)
ggplot(normal500, aes(Time)) + geom_histogram(binwidth = 50,color = 'blue') + labs(title = 'Switch Time Distribution')
ggplot(normal500, aes(Time, colour = 'blue')) + geom_histogram(binwidth = 50) + labs(title = 'Switch Time Distribution')
ggplot(normal500, aes(Time, colour = 'blue')) + geom_histogram(binwidth = 50) + labs(title = 'Switch Time Distribution')
ggplot(normal500, aes(Time)) + geom_histogram(binwidth = 50,color = "#000000", fill = "#0099F8") + labs(title = 'Switch Time Distribution')
ggsave('plots/Distribution_switch_time.svg', plot = last_plot(),dpi = 360)
moment <- Initial_val500 %>% group_by(Specie, Quant_spec) %>% count(Quant_spec) %>% mutate(perc = n)
missing_data <- data.frame(Specie = NA,Quant_spec = NA,n = NA, perc = NA)
for (spec in unique(moment$Specie)){
selected_spec = moment[which(moment$Specie == spec),]$Quant_spec
for (val in seq(0,1000,50)){
if (val %nin% selected_spec){
mom <- data.frame(Specie = spec, Quant_spec = val, n = 0 , perc = 0 )
missing_data <- rbind(missing_data,mom)
}
}
}
`%nin%` <- Negate(`%in%`)
moment <- Initial_val500 %>% group_by(Specie, Quant_spec) %>% count(Quant_spec) %>% mutate(perc = n)
missing_data <- data.frame(Specie = NA,Quant_spec = NA,n = NA, perc = NA)
for (spec in unique(moment$Specie)){
selected_spec = moment[which(moment$Specie == spec),]$Quant_spec
for (val in seq(0,1000,50)){
if (val %nin% selected_spec){
mom <- data.frame(Specie = spec, Quant_spec = val, n = 0 , perc = 0 )
missing_data <- rbind(missing_data,mom)
}
}
}
moment <- rbind(moment,missing_data %>% na.omit())
ggplot(moment, aes(Quant_spec, Specie, fill= perc)) +
geom_tile(color = 'black') +
geom_text(aes(label = perc), color = "white", size = 2.5) +
scale_fill_gradient(low = '#605b8f',high = '#de425b') +
guides(fill = guide_colorbar(title = 'Percentage')) +
labs(title = 'Sensitivity Analysis Species',caption = paste0('Normal status:',as.character(nrow(normal500)),'%'),x = 'Quantity specie',y = "Species")
# ggplot(moment, aes(perc,Specie, fill = Specie)) + geom_boxplot() + geom_point(position = position_dodge(),aes(group = perc , colour = Quant_spec)) +
#   geom_vline(xintercept = nrow(normal500), colour = '#b91000', lwd= 0.4) +
#   scale_colour_gradient(low = '#605b8f',high = '#de425b')+ labs(title = 'Sensitivity Analysis Species TF_a 500',x='Percentage %' ,y='Species',caption = paste0('Normal status:',as.character(nrow(normal500)),'%'))
ggsave('plots/Sensitivity_Analysis_Species_percentages.svg', plot = last_plot(),dpi = 360)
Initial_val500[which(Initial_val500$Specie == 'inhibitor_p'),]$Specie <- 'WEE1'
load('env_total.Rdata')
# update lable for human
Initial_val500[which(Initial_val500$Specie == 'inhibitor_p'),]$Specie <- 'WEE1'
Initial_val500[which(Initial_val500$Specie == 'TF_a'),]$Specie <- 'FOXM1_plus_CTAK1'
Initial_val500[which(Initial_val500$Specie == 'E_1'),]$Specie <- 'FCP1'
Initial_val500[which(Initial_val500$Specie == 'E_2'),]$Specie <- 'C_TAK1'
Initial_val500[which(Initial_val500$Specie == 'Chp_a'),]$Specie <- 'CHK1'
#times
ggplot(data=Initial_val500 %>% group_by(Specie, Quant_spec) %>% summarise(Mean = mean(Time)), aes(Mean, Specie, fill = Specie)) +
geom_boxplot() + geom_vline(xintercept = mean(normal500$Time), colour = 'red', lwd =0.2) +
geom_point(position=position_dodge(),aes(group = Mean, colour = Quant_spec)) +
scale_colour_gradient(low = '#605b8f',high = '#de425b') + labs(title = 'Sensitivity Analysis Species',x='Time' ,y='Species')
unique(Initial_val500$Specie)
Initial_val500[which(Initial_val500$Specie == 'E1'),]$Specie <- 'FCP1'
Initial_val500[which(Initial_val500$Specie == 'E2'),]$Specie <- 'C_TAK1'
setwd('../plots')
#times
ggplot(data=Initial_val500 %>% group_by(Specie, Quant_spec) %>% summarise(Mean = mean(Time)), aes(Mean, Specie, fill = Specie)) +
geom_boxplot() + geom_vline(xintercept = mean(normal500$Time), colour = 'red', lwd =0.2) +
geom_point(position=position_dodge(),aes(group = Mean, colour = Quant_spec)) +
scale_colour_gradient(low = '#605b8f',high = '#de425b') + labs(title = 'Sensitivity Analysis Species',x='Time' ,y='Species')
ggsave('plots/Sensitivity_Analysis_Species_barplot.svg', plot = last_plot(),dpi = 360)
moment <- Initial_val500 %>% group_by(Specie, Quant_spec) %>% count(Quant_spec) %>% mutate(perc = n)
missing_data <- data.frame(Specie = NA,Quant_spec = NA,n = NA, perc = NA)
for (spec in unique(moment$Specie)){
selected_spec = moment[which(moment$Specie == spec),]$Quant_spec
for (val in seq(0,1000,50)){
if (val %nin% selected_spec){
mom <- data.frame(Specie = spec, Quant_spec = val, n = 0 , perc = 0 )
missing_data <- rbind(missing_data,mom)
}
}
}
moment <- rbind(moment,missing_data %>% na.omit())
ggplot(moment, aes(Quant_spec, Specie, fill= perc)) +
geom_tile(color = 'black') +
geom_text(aes(label = perc), color = "white", size = 2.5) +
scale_fill_gradient(low = '#605b8f',high = '#de425b') +
guides(fill = guide_colorbar(title = 'Percentage')) +
labs(title = 'Sensitivity Analysis Species',caption = paste0('Normal status:',as.character(nrow(normal500)),'%'),x = 'Quantity specie',y = "Species")
# ggplot(moment, aes(perc,Specie, fill = Specie)) + geom_boxplot() + geom_point(position = position_dodge(),aes(group = perc , colour = Quant_spec)) +
#   geom_vline(xintercept = nrow(normal500), colour = '#b91000', lwd= 0.4) +
#   scale_colour_gradient(low = '#605b8f',high = '#de425b')+ labs(title = 'Sensitivity Analysis Species TF_a 500',x='Percentage %' ,y='Species',caption = paste0('Normal status:',as.character(nrow(normal500)),'%'))
ggsave('plots/Sensitivity_Analysis_Species_percentages.svg', plot = last_plot(),dpi = 360)
View(par_500)
moment1 <- par_500 %>% group_by(Parameter, Quant_par) %>% count(Quant_par) %>% mutate(perc = n)
ggplot(moment1, aes(perc,Parameter, fill = Parameter)) + geom_boxplot() + geom_vline(xintercept = nrow(normal500), colour = 'red', lwd= 0.2) +
geom_point(position = position_dodge(),aes(group = perc , colour = Quant_par)) +
scale_colour_gradient(low = '#605b8f',high = '#de425b') + labs(title = 'Sensitivity Analysis Parameters TF_a 500',x='Percentage %' ,y='Parameters')
# plotting parameters  #####
#times
ggplot(data=par_500 %>% group_by(Parameter, Quant_par) %>% summarise(Mean = mean(Time)), aes(Mean, Parameter, fill = Parameter)) +
geom_boxplot() + geom_vline(xintercept = mean(normal500$Time), colour = 'red', lwd =1) +
geom_point(position=position_dodge(),aes(group = Mean, colour = Quant_par)) +
scale_colour_gradient(low = '#605b8f',high = '#de425b') + labs(title = 'Sensitivity Analysis Parameters TF_a 500',x='Time' ,y='Parameters')
View(par_500)
# plotting parameters  #####
#times
parameters_of_interes <- c('kms','kma','jma','kmi','jmi','kmd','kmd_1','jwa','kwi','perc','jwi','kca','jca','kci','jci','kcd','kcs','kcd_1','kcp_7','jcp_7','kcp_6','jcp_6','jcp_1',
'kcp_1','kcp_2','jcp_2','jcp_5','kcp_5','jcp_3','kcp_3','jcp_4','kcp_4','kmi_1','kcp_8','jcp_8')
par_500 <- par_500[which(par_500$Parameter %in% parameters_of_interes),]
par_500 <- par_500 %>% mutate(Slots = case_when(Parameter == 'kms' ~ Quant_par / 0.004,
Parameter == 'kma' ~ Quant_par / 0.5,
Parameter == 'jma' ~ Quant_par / 1,
Parameter == 'kmi' ~ Quant_par  / 0.5,
Parameter == 'jmi' ~ Quant_par  / 1,
Parameter == 'kmd' ~ Quant_par  / 0.002,
Parameter == 'kmd_1' ~ Quant_par / 0.002,
Parameter == 'jwa' ~ Quant_par / 0.1,
Parameter == 'kwi' ~ Quant_par / 2,
Parameter == 'perc' ~ Quant_par / 0.01,
Parameter == 'jwi' ~ Quant_par / 0.1,
Parameter == 'kca' ~ Quant_par / 2,
Parameter == 'jca' ~ Quant_par / 0.1,
Parameter == 'kci' ~ Quant_par / 0.2,
Parameter == 'jci' ~ Quant_par / 0.1,
Parameter == 'kcd' ~ Quant_par / 0.01,
Parameter == 'kcs' ~ Quant_par / 0.01,
Parameter == 'kcd_1' ~ Quant_par / 0.01,
Parameter == 'kcp_7' ~ Quant_par / 0.2,
Parameter == 'jcp_7' ~ Quant_par / 0.1,
Parameter == 'kcp_6' ~ Quant_par / 0.2,
Parameter == 'jcp_6' ~ Quant_par / 0.1,
Parameter == 'kcp_1' ~ Quant_par / 0.1,
Parameter == 'jcp_1' ~ Quant_par / 2,
Parameter == 'kcp_2' ~ Quant_par / 0.2,
Parameter == 'jcp_2' ~ Quant_par / 0.1,
Parameter == 'kcp_5' ~ Quant_par / 0.2,
Parameter == 'jcp_5' ~ Quant_par / 0.1,
Parameter == 'kcp_4' ~ Quant_par / 2,
Parameter == 'jcp_4' ~ Quant_par / 0.1,
Parameter == 'kcp_3' ~ Quant_par / 2,
Parameter == 'jcp_3' ~ Quant_par / 0.1,
Parameter == 'kmi_1' ~ Quant_par / 2,
Parameter == 'kcp_8' ~ Quant_par / 0.1,
Parameter == 'jcp_8' ~ Quant_par / 0.1,
))
View(par_500)
